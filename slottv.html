<html>
<head>
<script src="playerjs.js" type="text/javascript"></script>
</head>
<body>
   <style>
      html, body{
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }
              #live_off {
            display: none; /* Скрываем изображение по умолчанию */
            width: 100%; /* Устанавливаем ширину изображения */
            height: auto; /* Автоматическая высота для сохранения пропорций */
        }
   </style><img id="live_off" src="https://github.com/star-dom/storage/blob/main/time_live-off.png?raw=true">
<div id="playerjs" style="width: 100%; height: 100%;"></div>
<script>
        const streamUrl = 'https://hs-cors.herokuapp.com/https://timetv.cloudpub.ru/live/hls/stream.m3u8';
        const playerElement = document.getElementById('playerjs');
        const liveOffImage = document.getElementById('live_off');

        async function checkStream() {
            try {
                const response = await fetch(streamUrl, { method: 'HEAD' });
                
                if (response.status === 502) {
                    // При получении ошибки 502, прячем плеер и показываем изображение
                    playerElement.style.display = 'none';
                    liveOffImage.style.display = 'block';
                } else {
                    playerElement.style.display = 'block';
                    liveOffImage.style.display = 'none';
                    // Инициализируем плеер, если потоком можно пользоваться
                    initPlayer();
                }
            } catch (error) {
                console.error('Error fetching stream:', error);
                // В случае ошибки, тоже показываем изображение
                playerElement.style.display = 'none';
                liveOffImage.style.display = 'block';
            }
        }

        function initPlayer() {
            // Здесь должен быть код инициализации вашего плеера
            var player = new Playerjs({id:"playerjs", file:streamUrl, poster:"https://github.com/star-dom/storage/blob/main/live_time.png?raw=true"}); // Пример инициализации
        }

        // Запустим проверку потока
        checkStream();
</script>
  </body>
</html>
